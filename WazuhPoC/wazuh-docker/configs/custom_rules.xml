<!-- Custom rules for multi-tenant Wazuh PoC -->
<group name="custom,">
  <!-- EICAR ransomware detection rule -->
  <rule id="100001" level="12">
    <if_sid>550</if_sid>
    <field name="md5">44d88612fea8a8f36de82e1278abb02f</field>
    <description>EICAR test file detected (possible ransomware test)</description>
    <group>custom,org-1,antivirus,eicar</group>
    <mitre>
      <id>T1204.002</id>
    </mitre>
  </rule>

  <!-- SSH brute-force detection rule -->
  <rule id="100002" level="10" frequency="6" timeframe="120">
    <if_sid>5710</if_sid>
    <description>SSH brute-force attack detected (multiple failed login attempts)</description>
    <group>custom,org-1,authentication_failures,sshd</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>

  <!-- Privilege escalation detection rule -->
  <rule id="100003" level="8">
    <if_sid>5400</if_sid>
    <match>sudo:|su:</match>
    <description>Privilege escalation attempt detected</description>
    <group>custom,org-2,privilege_escalation,sudo</group>
    <mitre>
      <id>T1548.003</id>
    </mitre>
  </rule>

  <!-- Network scanning detection rule -->
  <rule id="100004" level="7">
    <if_sid>5716</if_sid>
    <match>nmap|masscan|zmap</match>
    <description>Network scanning tool detected</description>
    <group>custom,org-3,reconnaissance,network_scan</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>

  <!-- Suspicious file modification detection rule -->
  <rule id="100005" level="6">
    <if_sid>550</if_sid>
    <field name="file">/etc/passwd|/etc/shadow|/etc/sudoers</field>
    <description>Suspicious modification of critical system file</description>
    <group>custom,org-4,system_integrity,file_modification</group>
    <mitre>
      <id>T1565.001</id>
    </mitre>
  </rule>

  <!-- Multi-tenant organization labeling rules -->
  <rule id="100010" level="0">
    <decoded_as>syslog</decoded_as>
    <field name="agent.name">org-1-agent</field>
    <description>Label event from org-1</description>
    <group>org-1</group>
  </rule>

  <rule id="100011" level="0">
    <decoded_as>syslog</decoded_as>
    <field name="agent.name">org-2-agent</field>
    <description>Label event from org-2</description>
    <group>org-2</group>
  </rule>

  <rule id="100012" level="0">
    <decoded_as>syslog</decoded_as>
    <field name="agent.name">org-3-agent</field>
    <description>Label event from org-3</description>
    <group>org-3</group>
  </rule>

  <rule id="100013" level="0">
    <decoded_as>syslog</decoded_as>
    <field name="agent.name">org-4-agent</field>
    <description>Label event from org-4</description>
    <group>org-4</group>
  </rule>
</group>
