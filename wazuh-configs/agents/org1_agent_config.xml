<!--
  Wazuh Agent Configuration for org-1
  This configuration is for the agent in organization 1
  Multi-tenant setup with labels for organization identification
-->

<ossec_config>
  <!-- Client configuration for connecting to Wazuh Manager -->
  <client>
    <server>
      <address>192.168.56.10</address>  <!-- IP of the Wazuh Manager (REINSURER VM) -->
      <port>1514</port>               <!-- Default port for agent communication -->
      <protocol>tcp</protocol>          <!-- Communication protocol -->
    </server>
    <config-profile>org-1</config-profile>  <!-- Profile name for this agent -->
    <notify_time>10</notify_time>          <!-- Time in seconds between state notifications -->
    <time_reconnect>60</time_reconnect>    <!-- Time in seconds to reconnect if connection is lost -->
    <auto_restart>yes</auto_restart>       <!-- Automatically restart agent if it crashes -->
    <crypto_method>aes</crypto_method>      <!-- Encryption method for communication -->
  </client>

  <!-- Agent-specific labels for multi-tenant identification -->
  <!-- These labels are used for Document Level Security (DLS) in OpenSearch -->
  <labels>
    <label key="organisation" value="org-1"/>  <!-- Organization identifier -->
    <label key="tenant" value="INSURER1"/>      <!-- Tenant identifier -->
    <label key="department" value="SME"/>         <!-- Department type -->
  </labels>

  <!-- File integrity monitoring configuration -->
  <syscheck>
    <disabled>no</disabled>  <!-- Enable file integrity monitoring -->

    <!-- Frequency that syscheck is executed - every 6 hours (21600 seconds) -->
    <frequency>21600</frequency>

    <!-- Perform a full scan on agent startup -->
    <scan_on_start>yes</scan_on_start>

    <!-- Critical system directories to monitor for changes -->
    <directories check_all="yes">/etc,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes">/bin,/sbin</directories>

    <!-- Files/directories to ignore -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>
    <ignore>/etc/utmpx</ignore>
    <ignore>/etc/wtmpx</ignore>
    <ignore>/etc/cups/certs</ignore>
    <ignore>/etc/dumpdates</ignore>
    <ignore>/etc/svc/volatile</ignore>
    <ignore>/sys/kernel/security</ignore>
    <ignore>/var/run/syslog.pid</ignore>
    <ignore>/var/run/utmp</ignore>
    <ignore>/var/run/wtmp</ignore>
    <ignore>/var/spool/exim/db</ignore>

    <!-- Check the file, but never compute the diff -->
    <nodiff>/etc/ssl/private.key</nodiff>

    <skip_nfs>yes</skip_nfs>

    <!-- Remove old entries -->
    <remove_old_entries>yes</remove_old_entries>
  </syscheck>

  <!-- Local rootcheck configuration -->
  <rootcheck>
    <disabled>no</disabled>
    <check_files>yes</check_files>
    <check_trojans>yes</check_trojans>
    <check_dev>yes</check_dev>
    <check_sys>yes</check_sys>
    <check_pids>yes</check_pids>
    <check_ports>yes</check_ports>
    <check_if>yes</check_if>

    <!-- Rootcheck frequency -->
    <frequency>43200</frequency>
  </rootcheck>

  <!-- Local file monitoring configuration -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
    <location>/var/log/auth.log</location>
    <location>/var/log/secure</location>
    <location>/var/log/messages</location>
  </localfile>

  <!-- Active response configuration -->
  <active-response>
    <disabled>yes</disabled>
  </active-response>
</ossec_config>
