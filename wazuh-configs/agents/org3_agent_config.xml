<!--
  Wazuh Agent Configuration for org-3
  This configuration is for the agent in organization 3
-->

<ossec_config>
  <client>
    <server>
      <address>192.168.56.10</address>
      <port>1514</port>
      <protocol>tcp</protocol>
    </server>
    <config-profile>org-3</config-profile>
    <notify_time>10</notify_time>
    <time_reconnect>60</time_reconnect>
    <auto_restart>yes</auto_restart>
    <crypto_method>aes</crypto_method>
  </client>

  <!-- Agent-specific labels for multi-tenant identification -->
  <!-- These labels are used for Document Level Security (DLS) in OpenSearch -->
  <labels>
    <label key="organisation" value="org-3"/>  <!-- Organization identifier -->
    <label key="tenant" value="INSURER2"/>      <!-- Tenant identifier -->
    <label key="department" value="SME"/>         <!-- Department type -->
  </labels>

  <!-- Local syscheck configuration -->
  <syscheck>
    <disabled>no</disabled>

    <!-- Frequency that syscheck is executed - every 6 hours -->
    <frequency>21600</frequency>

    <!-- Scan on startup -->
    <scan_on_start>yes</scan_on_start>

    <!-- Directories to check -->
    <directories check_all="yes">/etc,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes">/bin,/sbin</directories>

    <!-- Files/directories to ignore -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>
    <ignore>/etc/utmpx</ignore>
    <ignore>/etc/wtmpx</ignore>
    <ignore>/etc/cups/certs</ignore>
    <ignore>/etc/dumpdates</ignore>
    <ignore>/etc/svc/volatile</ignore>
    <ignore>/sys/kernel/security</ignore>
    <ignore>/var/run/syslog.pid</ignore>
    <ignore>/var/run/utmp</ignore>
    <ignore>/var/run/wtmp</ignore>
    <ignore>/var/spool/exim/db</ignore>

    <!-- Check the file, but never compute the diff -->
    <nodiff>/etc/ssl/private.key</nodiff>

    <skip_nfs>yes</skip_nfs>

    <!-- Remove old entries -->
    <remove_old_entries>yes</remove_old_entries>
  </syscheck>

  <!-- Local rootcheck configuration -->
  <rootcheck>
    <disabled>no</disabled>
    <check_files>yes</check_files>
    <check_trojans>yes</check_trojans>
    <check_dev>yes</check_dev>
    <check_sys>yes</check_sys>
    <check_pids>yes</check_pids>
    <check_ports>yes</check_ports>
    <check_if>yes</check_if>

    <!-- Rootcheck frequency -->
    <frequency>43200</frequency>
  </rootcheck>

  <!-- Local file monitoring configuration -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
    <location>/var/log/auth.log</location>
    <location>/var/log/secure</location>
    <location>/var/log/messages</location>
  </localfile>

  <!-- Active response configuration -->
  <active-response>
    <disabled>yes</disabled>
  </active-response>
</ossec_config>
